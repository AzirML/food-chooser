<!DOCTYPE html>
<html>
<head>
    <title>ä»Šå¤©åƒä»€ä¹ˆï¼Ÿ</title>
    <style>
        body { font-family: Arial; max-width: 600px; margin: 0 auto; padding: 20px; }
        h1 { color: #e67e22; text-align: center; }
        .dish { background: white; padding: 15px; margin: 10px; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        button { background: #e67e22; color: white; border: none; padding: 12px; width: 100%; font-size: 16px; margin-top: 20px; }
        .loading { text-align: center; padding: 40px; }
    </style>
</head>
<body>
    <h1>ğŸ½ï¸ ä»Šå¤©åƒä»€ä¹ˆï¼Ÿ</h1>
    <div id="menu">
        <div class="loading">åŠ è½½ä¸­...</div>
    </div>
    <button onclick="shareChoice()" disabled id="shareBtn">ğŸ“¤ åˆ†äº«é€‰æ‹©</button>
    <button onclick="selectRandom()">ğŸ² éšæœºé€‰æ‹©</button>
    
    <script>
        let dishes = [];
        let selectedDish = null;
        
        async function loadMenu() {
            try {
                const response = await fetch('/api/menu');
                dishes = await response.json();
                displayMenu();
            } catch (error) {
                document.getElementById('menu').innerHTML = 
                    '<div style="color:red; text-align:center;">åŠ è½½å¤±è´¥ï¼Œè¯·åˆ·æ–°é‡è¯•</div>';
            }
        }
        
        function displayMenu() {
            const container = document.getElementById('menu');
            container.innerHTML = '';
            
            dishes.forEach((dish, index) => {
                const div = document.createElement('div');
                div.className = 'dish';
                div.innerHTML = `<strong>${dish.name}</strong><br>${dish.description}`;
                div.onclick = () => selectDish(index);
                container.appendChild(div);
            });
        }
        
        function selectDish(index) {
            selectedDish = dishes[index];
            document.getElementById('shareBtn').disabled = false;
            alert(`å·²é€‰æ‹©ï¼š${selectedDish.name}`);
        }
        
        function selectRandom() {
            if (dishes.length === 0) return;
            const randomIndex = Math.floor(Math.random() * dishes.length);
            selectDish(randomIndex);
        }
        
        function shareChoice() {
            if (!selectedDish) return;
            const text = `ä»Šå¤©æˆ‘æƒ³åƒï¼š${selectedDish.name}ï¼`;
            if (navigator.share) {
                navigator.share({ title: 'ä»Šå¤©åƒä»€ä¹ˆ', text: text });
            } else {
                navigator.clipboard.writeText(text);
                alert('å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼');
            }
        }
        
        loadMenu();
    </script>
</body>
</html>
